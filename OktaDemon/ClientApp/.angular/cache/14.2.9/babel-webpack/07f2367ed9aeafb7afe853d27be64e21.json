{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/Narean/source/repos/OktaDemon/OktaDemon/ClientApp/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\n\n/*!\n * Copyright (c) 2015-present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * \n * See the License for the specific language governing permissions and limitations under the License.\n */\nimport AuthApiError from '../../../errors/AuthApiError.js';\nimport { httpRequest } from '../../../http/request.js';\nimport 'tiny-emitter';\nimport 'js-cookie';\nimport 'cross-fetch';\nimport { divideActionParamsByMutability } from './actionParser.js';\n\nconst generateDirectFetch = function generateDirectFetch(authClient, {\n  actionDefinition,\n  defaultParamsForAction = {},\n  immutableParamsForAction = {},\n  toPersist = {}\n}) {\n  const target = actionDefinition.href;\n  return /*#__PURE__*/_asyncToGenerator(function* (params = {}) {\n    var _a;\n\n    const headers = {\n      'Content-Type': 'application/json',\n      'Accept': actionDefinition.accepts || 'application/ion+json'\n    };\n    const body = JSON.stringify(Object.assign(Object.assign(Object.assign({}, defaultParamsForAction), params), immutableParamsForAction));\n\n    try {\n      const response = yield httpRequest(authClient, {\n        url: target,\n        method: actionDefinition.method,\n        headers,\n        args: body,\n        withCredentials: (_a = toPersist === null || toPersist === void 0 ? void 0 : toPersist.withCredentials) !== null && _a !== void 0 ? _a : true\n      });\n      return authClient.idx.makeIdxResponse(Object.assign({}, response), toPersist, true);\n    } catch (err) {\n      if (!(err instanceof AuthApiError) || !(err === null || err === void 0 ? void 0 : err.xhr)) {\n        throw err;\n      }\n\n      const response = err.xhr;\n      const payload = response.responseJSON || JSON.parse(response.responseText);\n      const wwwAuthHeader = response.headers['WWW-Authenticate'] || response.headers['www-authenticate'];\n      const idxResponse = authClient.idx.makeIdxResponse(Object.assign({}, payload), toPersist, false);\n\n      if (response.status === 401 && wwwAuthHeader === 'Oktadevicejwt realm=\"Okta Device\"') {\n        idxResponse.stepUp = true;\n      }\n\n      return idxResponse;\n    }\n  });\n};\n\nconst generateIdxAction = function generateIdxAction(authClient, actionDefinition, toPersist) {\n  const generator = generateDirectFetch;\n  const {\n    defaultParams,\n    neededParams,\n    immutableParams\n  } = divideActionParamsByMutability(actionDefinition);\n  const action = generator(authClient, {\n    actionDefinition,\n    defaultParamsForAction: defaultParams[actionDefinition.name],\n    immutableParamsForAction: immutableParams[actionDefinition.name],\n    toPersist\n  });\n  action.neededParams = neededParams;\n  return action;\n};\n\nexport { generateIdxAction as default };","map":{"version":3,"names":["AuthApiError","httpRequest","divideActionParamsByMutability","generateDirectFetch","authClient","actionDefinition","defaultParamsForAction","immutableParamsForAction","toPersist","target","href","params","_a","headers","accepts","body","JSON","stringify","Object","assign","response","url","method","args","withCredentials","idx","makeIdxResponse","err","xhr","payload","responseJSON","parse","responseText","wwwAuthHeader","idxResponse","status","stepUp","generateIdxAction","generator","defaultParams","neededParams","immutableParams","action","name","default"],"sources":["C:/Users/Narean/source/repos/OktaDemon/OktaDemon/ClientApp/node_modules/@okta/okta-auth-js/esm/browser/idx/idxState/v1/generateIdxAction.js"],"sourcesContent":["/*!\n * Copyright (c) 2015-present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * \n * See the License for the specific language governing permissions and limitations under the License.\n */\n\nimport AuthApiError from '../../../errors/AuthApiError.js';\nimport { httpRequest } from '../../../http/request.js';\nimport 'tiny-emitter';\nimport 'js-cookie';\nimport 'cross-fetch';\nimport { divideActionParamsByMutability } from './actionParser.js';\n\nconst generateDirectFetch = function generateDirectFetch(authClient, { actionDefinition, defaultParamsForAction = {}, immutableParamsForAction = {}, toPersist = {} }) {\n    const target = actionDefinition.href;\n    return async function (params = {}) {\n        var _a;\n        const headers = {\n            'Content-Type': 'application/json',\n            'Accept': actionDefinition.accepts || 'application/ion+json',\n        };\n        const body = JSON.stringify(Object.assign(Object.assign(Object.assign({}, defaultParamsForAction), params), immutableParamsForAction));\n        try {\n            const response = await httpRequest(authClient, {\n                url: target,\n                method: actionDefinition.method,\n                headers,\n                args: body,\n                withCredentials: (_a = toPersist === null || toPersist === void 0 ? void 0 : toPersist.withCredentials) !== null && _a !== void 0 ? _a : true\n            });\n            return authClient.idx.makeIdxResponse(Object.assign({}, response), toPersist, true);\n        }\n        catch (err) {\n            if (!(err instanceof AuthApiError) || !(err === null || err === void 0 ? void 0 : err.xhr)) {\n                throw err;\n            }\n            const response = err.xhr;\n            const payload = response.responseJSON || JSON.parse(response.responseText);\n            const wwwAuthHeader = response.headers['WWW-Authenticate'] || response.headers['www-authenticate'];\n            const idxResponse = authClient.idx.makeIdxResponse(Object.assign({}, payload), toPersist, false);\n            if (response.status === 401 && wwwAuthHeader === 'Oktadevicejwt realm=\"Okta Device\"') {\n                idxResponse.stepUp = true;\n            }\n            return idxResponse;\n        }\n    };\n};\nconst generateIdxAction = function generateIdxAction(authClient, actionDefinition, toPersist) {\n    const generator = generateDirectFetch;\n    const { defaultParams, neededParams, immutableParams } = divideActionParamsByMutability(actionDefinition);\n    const action = generator(authClient, {\n        actionDefinition,\n        defaultParamsForAction: defaultParams[actionDefinition.name],\n        immutableParamsForAction: immutableParams[actionDefinition.name],\n        toPersist\n    });\n    action.neededParams = neededParams;\n    return action;\n};\n\nexport { generateIdxAction as default };\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}