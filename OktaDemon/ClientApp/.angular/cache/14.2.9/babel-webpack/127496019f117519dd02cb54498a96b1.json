{"ast":null,"code":"/*!\n * Copyright (c) 2015-present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * \n * See the License for the specific language governing permissions and limitations under the License.\n */\nimport { removeNils, clone } from '../util/object.js';\nimport { isString } from '../util/types.js';\nimport { isAbsoluteUrl } from '../util/url.js';\nimport { STATE_TOKEN_KEY_NAME, DEFAULT_CACHE_DURATION } from '../constants.js';\nimport AuthApiError from '../errors/AuthApiError.js';\nimport OAuthError from '../errors/OAuthError.js';\n\nfunction httpRequest(sdk, options) {\n  options = options || {};\n\n  if (sdk.options.httpRequestInterceptors) {\n    for (const interceptor of sdk.options.httpRequestInterceptors) {\n      interceptor(options);\n    }\n  }\n\n  var url = options.url,\n      method = options.method,\n      args = options.args,\n      saveAuthnState = options.saveAuthnState,\n      accessToken = options.accessToken,\n      withCredentials = options.withCredentials === true,\n      storageUtil = sdk.options.storageUtil,\n      storage = storageUtil.storage,\n      httpCache = sdk.storageManager.getHttpCache(sdk.options.cookies);\n\n  if (options.cacheResponse) {\n    var cacheContents = httpCache.getStorage();\n    var cachedResponse = cacheContents[url];\n\n    if (cachedResponse && Date.now() / 1000 < cachedResponse.expiresAt) {\n      return Promise.resolve(cachedResponse.response);\n    }\n  }\n\n  var oktaUserAgentHeader = sdk._oktaUserAgent.getHttpHeader();\n\n  var headers = Object.assign({\n    'Accept': 'application/json',\n    'Content-Type': 'application/json'\n  }, oktaUserAgentHeader);\n  Object.assign(headers, sdk.options.headers, options.headers);\n  headers = removeNils(headers);\n\n  if (accessToken && isString(accessToken)) {\n    headers['Authorization'] = 'Bearer ' + accessToken;\n  }\n\n  var ajaxOptions = {\n    headers,\n    data: args || undefined,\n    withCredentials\n  };\n  var err, res;\n  return sdk.options.httpRequestClient(method, url, ajaxOptions).then(function (resp) {\n    res = resp.responseText;\n\n    if (res && isString(res)) {\n      res = JSON.parse(res);\n\n      if (res && typeof res === 'object' && !res.headers) {\n        if (Array.isArray(res)) {\n          res.forEach(item => {\n            item.headers = resp.headers;\n          });\n        } else {\n          res.headers = resp.headers;\n        }\n      }\n    }\n\n    if (saveAuthnState) {\n      if (!res.stateToken) {\n        storage.delete(STATE_TOKEN_KEY_NAME);\n      }\n    }\n\n    if (res && res.stateToken && res.expiresAt) {\n      storage.set(STATE_TOKEN_KEY_NAME, res.stateToken, res.expiresAt, sdk.options.cookies);\n    }\n\n    if (res && options.cacheResponse) {\n      httpCache.updateStorage(url, {\n        expiresAt: Math.floor(Date.now() / 1000) + DEFAULT_CACHE_DURATION,\n        response: res\n      });\n    }\n\n    return res;\n  }).catch(function (resp) {\n    var serverErr = resp.responseText || {};\n\n    if (isString(serverErr)) {\n      try {\n        serverErr = JSON.parse(serverErr);\n      } catch (e) {\n        serverErr = {\n          errorSummary: 'Unknown error'\n        };\n      }\n    }\n\n    if (resp.status >= 500) {\n      serverErr.errorSummary = 'Unknown error';\n    }\n\n    if (sdk.options.transformErrorXHR) {\n      resp = sdk.options.transformErrorXHR(clone(resp));\n    }\n\n    if (serverErr.error && serverErr.error_description) {\n      err = new OAuthError(serverErr.error, serverErr.error_description);\n    } else {\n      err = new AuthApiError(serverErr, resp);\n    }\n\n    if (err.errorCode === 'E0000011') {\n      storage.delete(STATE_TOKEN_KEY_NAME);\n    }\n\n    throw err;\n  });\n}\n\nfunction get(sdk, url, options) {\n  url = isAbsoluteUrl(url) ? url : sdk.getIssuerOrigin() + url;\n  var getOptions = {\n    url: url,\n    method: 'GET'\n  };\n  Object.assign(getOptions, options);\n  return httpRequest(sdk, getOptions);\n}\n\nfunction post(sdk, url, args, options) {\n  url = isAbsoluteUrl(url) ? url : sdk.getIssuerOrigin() + url;\n  var postOptions = {\n    url: url,\n    method: 'POST',\n    args: args,\n    saveAuthnState: true\n  };\n  Object.assign(postOptions, options);\n  return httpRequest(sdk, postOptions);\n}\n\nexport { get, httpRequest, post };","map":{"version":3,"names":["removeNils","clone","isString","isAbsoluteUrl","STATE_TOKEN_KEY_NAME","DEFAULT_CACHE_DURATION","AuthApiError","OAuthError","httpRequest","sdk","options","httpRequestInterceptors","interceptor","url","method","args","saveAuthnState","accessToken","withCredentials","storageUtil","storage","httpCache","storageManager","getHttpCache","cookies","cacheResponse","cacheContents","getStorage","cachedResponse","Date","now","expiresAt","Promise","resolve","response","oktaUserAgentHeader","_oktaUserAgent","getHttpHeader","headers","Object","assign","ajaxOptions","data","undefined","err","res","httpRequestClient","then","resp","responseText","JSON","parse","Array","isArray","forEach","item","stateToken","delete","set","updateStorage","Math","floor","catch","serverErr","e","errorSummary","status","transformErrorXHR","error","error_description","errorCode","get","getIssuerOrigin","getOptions","post","postOptions"],"sources":["C:/Users/Narean/source/repos/OktaDemon/OktaDemon/ClientApp/node_modules/@okta/okta-auth-js/esm/browser/http/request.js"],"sourcesContent":["/*!\n * Copyright (c) 2015-present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * \n * See the License for the specific language governing permissions and limitations under the License.\n */\n\nimport { removeNils, clone } from '../util/object.js';\nimport { isString } from '../util/types.js';\nimport { isAbsoluteUrl } from '../util/url.js';\nimport { STATE_TOKEN_KEY_NAME, DEFAULT_CACHE_DURATION } from '../constants.js';\nimport AuthApiError from '../errors/AuthApiError.js';\nimport OAuthError from '../errors/OAuthError.js';\n\nfunction httpRequest(sdk, options) {\n    options = options || {};\n    if (sdk.options.httpRequestInterceptors) {\n        for (const interceptor of sdk.options.httpRequestInterceptors) {\n            interceptor(options);\n        }\n    }\n    var url = options.url, method = options.method, args = options.args, saveAuthnState = options.saveAuthnState, accessToken = options.accessToken, withCredentials = options.withCredentials === true,\n    storageUtil = sdk.options.storageUtil, storage = storageUtil.storage, httpCache = sdk.storageManager.getHttpCache(sdk.options.cookies);\n    if (options.cacheResponse) {\n        var cacheContents = httpCache.getStorage();\n        var cachedResponse = cacheContents[url];\n        if (cachedResponse && Date.now() / 1000 < cachedResponse.expiresAt) {\n            return Promise.resolve(cachedResponse.response);\n        }\n    }\n    var oktaUserAgentHeader = sdk._oktaUserAgent.getHttpHeader();\n    var headers = Object.assign({ 'Accept': 'application/json', 'Content-Type': 'application/json' }, oktaUserAgentHeader);\n    Object.assign(headers, sdk.options.headers, options.headers);\n    headers = removeNils(headers);\n    if (accessToken && isString(accessToken)) {\n        headers['Authorization'] = 'Bearer ' + accessToken;\n    }\n    var ajaxOptions = {\n        headers,\n        data: args || undefined,\n        withCredentials\n    };\n    var err, res;\n    return sdk.options.httpRequestClient(method, url, ajaxOptions)\n        .then(function (resp) {\n        res = resp.responseText;\n        if (res && isString(res)) {\n            res = JSON.parse(res);\n            if (res && typeof res === 'object' && !res.headers) {\n                if (Array.isArray(res)) {\n                    res.forEach(item => {\n                        item.headers = resp.headers;\n                    });\n                }\n                else {\n                    res.headers = resp.headers;\n                }\n            }\n        }\n        if (saveAuthnState) {\n            if (!res.stateToken) {\n                storage.delete(STATE_TOKEN_KEY_NAME);\n            }\n        }\n        if (res && res.stateToken && res.expiresAt) {\n            storage.set(STATE_TOKEN_KEY_NAME, res.stateToken, res.expiresAt, sdk.options.cookies);\n        }\n        if (res && options.cacheResponse) {\n            httpCache.updateStorage(url, {\n                expiresAt: Math.floor(Date.now() / 1000) + DEFAULT_CACHE_DURATION,\n                response: res\n            });\n        }\n        return res;\n    })\n        .catch(function (resp) {\n        var serverErr = resp.responseText || {};\n        if (isString(serverErr)) {\n            try {\n                serverErr = JSON.parse(serverErr);\n            }\n            catch (e) {\n                serverErr = {\n                    errorSummary: 'Unknown error'\n                };\n            }\n        }\n        if (resp.status >= 500) {\n            serverErr.errorSummary = 'Unknown error';\n        }\n        if (sdk.options.transformErrorXHR) {\n            resp = sdk.options.transformErrorXHR(clone(resp));\n        }\n        if (serverErr.error && serverErr.error_description) {\n            err = new OAuthError(serverErr.error, serverErr.error_description);\n        }\n        else {\n            err = new AuthApiError(serverErr, resp);\n        }\n        if (err.errorCode === 'E0000011') {\n            storage.delete(STATE_TOKEN_KEY_NAME);\n        }\n        throw err;\n    });\n}\nfunction get(sdk, url, options) {\n    url = isAbsoluteUrl(url) ? url : sdk.getIssuerOrigin() + url;\n    var getOptions = {\n        url: url,\n        method: 'GET'\n    };\n    Object.assign(getOptions, options);\n    return httpRequest(sdk, getOptions);\n}\nfunction post(sdk, url, args, options) {\n    url = isAbsoluteUrl(url) ? url : sdk.getIssuerOrigin() + url;\n    var postOptions = {\n        url: url,\n        method: 'POST',\n        args: args,\n        saveAuthnState: true\n    };\n    Object.assign(postOptions, options);\n    return httpRequest(sdk, postOptions);\n}\n\nexport { get, httpRequest, post };\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}