{"ast":null,"code":"/*!\n * Copyright (c) 2015-present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * \n * See the License for the specific language governing permissions and limitations under the License.\n */\nimport { find, omit } from '../../util/object.js';\nimport { toQueryString } from '../../util/url.js';\nimport AuthSdkError from '../../errors/AuthSdkError.js';\nimport { get } from '../../http/request.js';\nimport 'tiny-emitter';\nimport 'js-cookie';\nimport 'cross-fetch';\nimport { postToTransaction } from '../api.js';\nimport { addStateToken } from './stateToken.js';\n\nfunction link2fn(sdk, tx, res, obj, link, ref) {\n  if (Array.isArray(link)) {\n    return function (name, opts) {\n      if (!name) {\n        throw new AuthSdkError('Must provide a link name');\n      }\n\n      var lk = find(link, {\n        name: name\n      });\n\n      if (!lk) {\n        throw new AuthSdkError('No link found for that name');\n      }\n\n      return link2fn(sdk, tx, res, obj, lk, ref)(opts);\n    };\n  } else if (link.hints && link.hints.allow && link.hints.allow.length === 1) {\n    var method = link.hints.allow[0];\n\n    switch (method) {\n      case 'GET':\n        return function () {\n          return get(sdk, link.href, {\n            withCredentials: true\n          });\n        };\n\n      case 'POST':\n        return function (opts) {\n          if (ref && ref.isPolling) {\n            ref.isPolling = false;\n          }\n\n          var data = addStateToken(res, opts);\n\n          if (res.status === 'MFA_ENROLL' || res.status === 'FACTOR_ENROLL') {\n            Object.assign(data, {\n              factorType: obj.factorType,\n              provider: obj.provider\n            });\n          }\n\n          var params = {};\n          var autoPush = data.autoPush;\n\n          if (autoPush !== undefined) {\n            if (typeof autoPush === 'function') {\n              try {\n                params.autoPush = !!autoPush();\n              } catch (e) {\n                return Promise.reject(new AuthSdkError('AutoPush resulted in an error.'));\n              }\n            } else if (autoPush !== null) {\n              params.autoPush = !!autoPush;\n            }\n\n            data = omit(data, 'autoPush');\n          }\n\n          var rememberDevice = data.rememberDevice;\n\n          if (rememberDevice !== undefined) {\n            if (typeof rememberDevice === 'function') {\n              try {\n                params.rememberDevice = !!rememberDevice();\n              } catch (e) {\n                return Promise.reject(new AuthSdkError('RememberDevice resulted in an error.'));\n              }\n            } else if (rememberDevice !== null) {\n              params.rememberDevice = !!rememberDevice;\n            }\n\n            data = omit(data, 'rememberDevice');\n          } else if (data.profile && data.profile.updatePhone !== undefined) {\n            if (data.profile.updatePhone) {\n              params.updatePhone = true;\n            }\n\n            data.profile = omit(data.profile, 'updatePhone');\n          }\n\n          var href = link.href + toQueryString(params);\n          return postToTransaction(sdk, tx, href, data);\n        };\n    }\n  }\n}\n\nexport { link2fn };","map":{"version":3,"names":["find","omit","toQueryString","AuthSdkError","get","postToTransaction","addStateToken","link2fn","sdk","tx","res","obj","link","ref","Array","isArray","name","opts","lk","hints","allow","length","method","href","withCredentials","isPolling","data","status","Object","assign","factorType","provider","params","autoPush","undefined","e","Promise","reject","rememberDevice","profile","updatePhone"],"sources":["C:/Users/Narean/source/repos/OktaDemon/OktaDemon/ClientApp/node_modules/@okta/okta-auth-js/esm/browser/authn/util/link2fn.js"],"sourcesContent":["/*!\n * Copyright (c) 2015-present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * \n * See the License for the specific language governing permissions and limitations under the License.\n */\n\nimport { find, omit } from '../../util/object.js';\nimport { toQueryString } from '../../util/url.js';\nimport AuthSdkError from '../../errors/AuthSdkError.js';\nimport { get } from '../../http/request.js';\nimport 'tiny-emitter';\nimport 'js-cookie';\nimport 'cross-fetch';\nimport { postToTransaction } from '../api.js';\nimport { addStateToken } from './stateToken.js';\n\nfunction link2fn(sdk, tx, res, obj, link, ref) {\n    if (Array.isArray(link)) {\n        return function (name, opts) {\n            if (!name) {\n                throw new AuthSdkError('Must provide a link name');\n            }\n            var lk = find(link, { name: name });\n            if (!lk) {\n                throw new AuthSdkError('No link found for that name');\n            }\n            return link2fn(sdk, tx, res, obj, lk, ref)(opts);\n        };\n    }\n    else if (link.hints &&\n        link.hints.allow &&\n        link.hints.allow.length === 1) {\n        var method = link.hints.allow[0];\n        switch (method) {\n            case 'GET':\n                return function () {\n                    return get(sdk, link.href, { withCredentials: true });\n                };\n            case 'POST':\n                return function (opts) {\n                    if (ref && ref.isPolling) {\n                        ref.isPolling = false;\n                    }\n                    var data = addStateToken(res, opts);\n                    if (res.status === 'MFA_ENROLL' || res.status === 'FACTOR_ENROLL') {\n                        Object.assign(data, {\n                            factorType: obj.factorType,\n                            provider: obj.provider\n                        });\n                    }\n                    var params = {};\n                    var autoPush = data.autoPush;\n                    if (autoPush !== undefined) {\n                        if (typeof autoPush === 'function') {\n                            try {\n                                params.autoPush = !!autoPush();\n                            }\n                            catch (e) {\n                                return Promise.reject(new AuthSdkError('AutoPush resulted in an error.'));\n                            }\n                        }\n                        else if (autoPush !== null) {\n                            params.autoPush = !!autoPush;\n                        }\n                        data = omit(data, 'autoPush');\n                    }\n                    var rememberDevice = data.rememberDevice;\n                    if (rememberDevice !== undefined) {\n                        if (typeof rememberDevice === 'function') {\n                            try {\n                                params.rememberDevice = !!rememberDevice();\n                            }\n                            catch (e) {\n                                return Promise.reject(new AuthSdkError('RememberDevice resulted in an error.'));\n                            }\n                        }\n                        else if (rememberDevice !== null) {\n                            params.rememberDevice = !!rememberDevice;\n                        }\n                        data = omit(data, 'rememberDevice');\n                    }\n                    else if (data.profile &&\n                        data.profile.updatePhone !== undefined) {\n                        if (data.profile.updatePhone) {\n                            params.updatePhone = true;\n                        }\n                        data.profile = omit(data.profile, 'updatePhone');\n                    }\n                    var href = link.href + toQueryString(params);\n                    return postToTransaction(sdk, tx, href, data);\n                };\n        }\n    }\n}\n\nexport { link2fn };\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}