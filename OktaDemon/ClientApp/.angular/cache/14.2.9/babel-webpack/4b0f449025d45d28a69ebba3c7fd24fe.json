{"ast":null,"code":"/*!\n * Copyright (c) 2015-present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * \n * See the License for the specific language governing permissions and limitations under the License.\n */\nimport { omit, getLink } from '../util/object.js';\nimport { toQueryString } from '../util/url.js';\nimport { get, post, httpRequest } from '../http/request.js';\nimport 'tiny-emitter';\nimport 'js-cookie';\nimport 'cross-fetch';\n\nfunction sessionExists(sdk) {\n  return sdk.session.get().then(function (res) {\n    if (res.status === 'ACTIVE') {\n      return true;\n    }\n\n    return false;\n  }).catch(function () {\n    return false;\n  });\n}\n\nfunction getSession(sdk) {\n  return get(sdk, '/api/v1/sessions/me', {\n    withCredentials: true\n  }).then(function (session) {\n    var res = omit(session, '_links');\n\n    res.refresh = function () {\n      return post(sdk, getLink(session, 'refresh').href, {}, {\n        withCredentials: true\n      });\n    };\n\n    res.user = function () {\n      return get(sdk, getLink(session, 'user').href, {\n        withCredentials: true\n      });\n    };\n\n    return res;\n  }).catch(function () {\n    return {\n      status: 'INACTIVE'\n    };\n  });\n}\n\nfunction closeSession(sdk) {\n  return httpRequest(sdk, {\n    url: sdk.getIssuerOrigin() + '/api/v1/sessions/me',\n    method: 'DELETE',\n    withCredentials: true\n  });\n}\n\nfunction refreshSession(sdk) {\n  return post(sdk, '/api/v1/sessions/me/lifecycle/refresh', {}, {\n    withCredentials: true\n  });\n}\n\nfunction setCookieAndRedirect(sdk, sessionToken, redirectUrl) {\n  redirectUrl = redirectUrl || window.location.href;\n  window.location.assign(sdk.getIssuerOrigin() + '/login/sessionCookieRedirect' + toQueryString({\n    checkAccountSetupComplete: true,\n    token: sessionToken,\n    redirectUrl: redirectUrl\n  }));\n}\n\nexport { closeSession, getSession, refreshSession, sessionExists, setCookieAndRedirect }; //# sourceMappingURL=api.js.map","map":null,"metadata":{},"sourceType":"module"}