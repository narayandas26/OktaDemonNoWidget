{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/Narean/source/repos/OktaDemon/OktaDemon/ClientApp/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\n\n/*!\n * Copyright (c) 2015-present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * \n * See the License for the specific language governing permissions and limitations under the License.\n */\nimport { isFunction } from '../util/types.js';\nimport AuthSdkError from '../errors/AuthSdkError.js';\nimport OAuthError from '../errors/OAuthError.js';\nimport { httpRequest } from '../http/request.js';\nimport 'tiny-emitter';\nimport 'js-cookie';\nimport 'cross-fetch';\nimport { isAccessToken, isIDToken } from './types/Token.js';\n\nfunction getUserInfo(_x, _x2, _x3) {\n  return _getUserInfo.apply(this, arguments);\n}\n\nfunction _getUserInfo() {\n  _getUserInfo = _asyncToGenerator(function* (sdk, accessTokenObject, idTokenObject) {\n    if (!accessTokenObject) {\n      accessTokenObject = (yield sdk.tokenManager.getTokens()).accessToken;\n    }\n\n    if (!idTokenObject) {\n      idTokenObject = (yield sdk.tokenManager.getTokens()).idToken;\n    }\n\n    if (!accessTokenObject || !isAccessToken(accessTokenObject)) {\n      return Promise.reject(new AuthSdkError('getUserInfo requires an access token object'));\n    }\n\n    if (!idTokenObject || !isIDToken(idTokenObject)) {\n      return Promise.reject(new AuthSdkError('getUserInfo requires an ID token object'));\n    }\n\n    return httpRequest(sdk, {\n      url: accessTokenObject.userinfoUrl,\n      method: 'GET',\n      accessToken: accessTokenObject.accessToken\n    }).then(userInfo => {\n      if (userInfo.sub === idTokenObject.claims.sub) {\n        return userInfo;\n      }\n\n      return Promise.reject(new AuthSdkError('getUserInfo request was rejected due to token mismatch'));\n    }).catch(function (err) {\n      if (err.xhr && (err.xhr.status === 401 || err.xhr.status === 403)) {\n        var authenticateHeader;\n\n        if (err.xhr.headers && isFunction(err.xhr.headers.get) && err.xhr.headers.get('WWW-Authenticate')) {\n          authenticateHeader = err.xhr.headers.get('WWW-Authenticate');\n        } else if (isFunction(err.xhr.getResponseHeader)) {\n          authenticateHeader = err.xhr.getResponseHeader('WWW-Authenticate');\n        }\n\n        if (authenticateHeader) {\n          var errorMatches = authenticateHeader.match(/error=\"(.*?)\"/) || [];\n          var errorDescriptionMatches = authenticateHeader.match(/error_description=\"(.*?)\"/) || [];\n          var error = errorMatches[1];\n          var errorDescription = errorDescriptionMatches[1];\n\n          if (error && errorDescription) {\n            err = new OAuthError(error, errorDescription);\n          }\n        }\n      }\n\n      throw err;\n    });\n  });\n  return _getUserInfo.apply(this, arguments);\n}\n\nexport { getUserInfo };","map":{"version":3,"names":["isFunction","AuthSdkError","OAuthError","httpRequest","isAccessToken","isIDToken","getUserInfo","sdk","accessTokenObject","idTokenObject","tokenManager","getTokens","accessToken","idToken","Promise","reject","url","userinfoUrl","method","then","userInfo","sub","claims","catch","err","xhr","status","authenticateHeader","headers","get","getResponseHeader","errorMatches","match","errorDescriptionMatches","error","errorDescription"],"sources":["C:/Users/Narean/source/repos/OktaDemon/OktaDemon/ClientApp/node_modules/@okta/okta-auth-js/esm/browser/oidc/getUserInfo.js"],"sourcesContent":["/*!\n * Copyright (c) 2015-present, Okta, Inc. and/or its affiliates. All rights reserved.\n * The Okta software accompanied by this notice is provided pursuant to the Apache License, Version 2.0 (the \"License.\")\n *\n * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0.\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * \n * See the License for the specific language governing permissions and limitations under the License.\n */\n\nimport { isFunction } from '../util/types.js';\nimport AuthSdkError from '../errors/AuthSdkError.js';\nimport OAuthError from '../errors/OAuthError.js';\nimport { httpRequest } from '../http/request.js';\nimport 'tiny-emitter';\nimport 'js-cookie';\nimport 'cross-fetch';\nimport { isAccessToken, isIDToken } from './types/Token.js';\n\nasync function getUserInfo(sdk, accessTokenObject, idTokenObject) {\n    if (!accessTokenObject) {\n        accessTokenObject = (await sdk.tokenManager.getTokens()).accessToken;\n    }\n    if (!idTokenObject) {\n        idTokenObject = (await sdk.tokenManager.getTokens()).idToken;\n    }\n    if (!accessTokenObject || !isAccessToken(accessTokenObject)) {\n        return Promise.reject(new AuthSdkError('getUserInfo requires an access token object'));\n    }\n    if (!idTokenObject || !isIDToken(idTokenObject)) {\n        return Promise.reject(new AuthSdkError('getUserInfo requires an ID token object'));\n    }\n    return httpRequest(sdk, {\n        url: accessTokenObject.userinfoUrl,\n        method: 'GET',\n        accessToken: accessTokenObject.accessToken\n    })\n        .then(userInfo => {\n        if (userInfo.sub === idTokenObject.claims.sub) {\n            return userInfo;\n        }\n        return Promise.reject(new AuthSdkError('getUserInfo request was rejected due to token mismatch'));\n    })\n        .catch(function (err) {\n        if (err.xhr && (err.xhr.status === 401 || err.xhr.status === 403)) {\n            var authenticateHeader;\n            if (err.xhr.headers && isFunction(err.xhr.headers.get) && err.xhr.headers.get('WWW-Authenticate')) {\n                authenticateHeader = err.xhr.headers.get('WWW-Authenticate');\n            }\n            else if (isFunction(err.xhr.getResponseHeader)) {\n                authenticateHeader = err.xhr.getResponseHeader('WWW-Authenticate');\n            }\n            if (authenticateHeader) {\n                var errorMatches = authenticateHeader.match(/error=\"(.*?)\"/) || [];\n                var errorDescriptionMatches = authenticateHeader.match(/error_description=\"(.*?)\"/) || [];\n                var error = errorMatches[1];\n                var errorDescription = errorDescriptionMatches[1];\n                if (error && errorDescription) {\n                    err = new OAuthError(error, errorDescription);\n                }\n            }\n        }\n        throw err;\n    });\n}\n\nexport { getUserInfo };\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}